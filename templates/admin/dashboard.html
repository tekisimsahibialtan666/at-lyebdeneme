{% extends 'base.html' %}
{% block title %}Admin Dashboard · Atölye B{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
{% endblock %}
{% block content %}
<section class="page-hero admin-hero">
  <div class="container">
    <h1>Admin Dashboard</h1>
    <p>Manage projects, review messages, and keep the studio presence up to date.</p>
  </div>
</section>

<section class="section admin-overview">
  <div class="container admin-grid">
    <div class="stat-card">
      <span class="stat-label">Projects</span>
      <span class="stat-value">{{ project_count }}</span>
      <a class="stat-link" href="{{ url_for('admin_projects') }}">Manage projects</a>
    </div>
    <div class="stat-card">
      <span class="stat-label">Messages</span>
      <span class="stat-value">{{ message_count }}</span>
      <a class="stat-link" href="{{ url_for('admin_messages') }}">View inbox</a>
    </div>
    <div class="stat-card">
      <span class="stat-label">Unread</span>
      <span class="stat-value">{{ unread_messages }}</span>
      <a class="stat-link" href="{{ url_for('admin_messages', status='new') }}">Review now</a>
    </div>
    <div class="stat-card">
      <span class="stat-label">Responded</span>
      <span class="stat-value">{{ status_counts['responded'] }}</span>
      <a class="stat-link" href="{{ url_for('admin_messages', status='responded') }}">View responses</a>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="card">
      <div class="card-header">
        <h2>Latest Messages</h2>
        <a class="btn btn-outline" href="{{ url_for('admin_messages') }}">Open inbox</a>
      </div>
      <div class="table-responsive">
        <table class="data-table">
          <thead>
            <tr>
              <th>From</th>
              <th>Email</th>
              <th>Received</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for message in latest_messages %}
              <tr>
                <td>{{ message.name }}</td>
                <td>{{ message.email }}</td>
                <td>{{ message.created_at.strftime('%d %b %Y %H:%M') }}</td>
                <td><span class="badge badge-neutral">{{ message.status.replace('_', ' ')|title }}</span></td>
              </tr>
            {% else %}
              <tr>
                <td colspan="4" class="empty">No messages yet.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container admin-grid">
    <div class="card">
      <div class="card-header">
        <h2>Message Status Overview</h2>
      </div>
      <ul class="status-list">
        <li><span>New</span><strong>{{ status_counts['new'] }}</strong></li>
        <li><span>In Progress</span><strong>{{ status_counts['in_progress'] }}</strong></li>
        <li><span>Responded</span><strong>{{ status_counts['responded'] }}</strong></li>
        <li><span>Archived</span><strong>{{ status_counts['archived'] }}</strong></li>
      </ul>
    </div>
    <div class="card">
      <div class="card-header">
        <h2>Recent Registrations</h2>
        <a class="btn btn-outline" href="{{ url_for('admin_users') }}">Manage users</a>
      </div>
      <ul class="user-list">
        {% for user in recent_users %}
          <li>
            <div>
              <strong>{{ user.name }}</strong>
              <span>{{ user.email }}</span>
            </div>
            <span class="user-meta">Joined {{ user.created_at.strftime('%d %b %Y') }}</span>
          </li>
        {% else %}
          <li class="empty">No registered users yet.</li>
        {% endfor %}
      </ul>
    </div>
    <div class="card">
      <div class="card-header">
        <h2>Brand Content</h2>
      </div>
      <p>Keep your story and contact details current so visitors always see accurate information.</p>
      <a class="btn btn-primary" href="{{ url_for('admin_about') }}">Edit About Page</a>
    </div>
  </div>
</section>
{% endblock %}
